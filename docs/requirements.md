# 工程管理ツール 要件定義書

**作成日**: 2025年10月13日  
**最終更新**: 2025年10月21日（V2.0.0対応）  
**バージョン**: 2.0  
**プロジェクト名**: Output Management Tool  
**実装状況**: V2.0.0（フェーズ2完了、バックエンドAPI実装完了）

> **重要**: V2.0.0で階層構造を撤廃し、フラットな工程表構造に変更しました。  
> 詳細は`V2_SPECIFICATION.md`を参照してください。

---

## 1. プロジェクト概要

### 1.1 目的
工程表・BPMNフローチャート・マニュアルを三位一体で統合管理し、BPMN 2.0の完全な情報を工程表に統合するデスクトップアプリケーションの開発。

**コア価値**:
- **工程表 ⇔ BPMN ⇔ マニュアル**: 完全な1対1対応と双方向同期
- **フラット構造**: 階層構造を撤廃し、ラベルで分類
- **スイムレーン・ステップ**: 時系列と責任部署を明確化
- **BPMN 2.0完全統合**: 全情報を工程表で管理
- **三位一体管理**: 一箇所の変更が全体に波及し、常に整合性を保つ

### 1.2 対象ユーザー
- プロジェクトマネージャー
- 業務プロセス設計者
- ITコンサルタント
- 工程管理担当者
- BPMN設計者

### 1.3 利用シーン
- 複数の工程表の作成・編集・管理
- スイムレーン（部署・担当者）とステップ（時系列）による工程管理
- 業務フローの可視化と編集（BPMNフロー）
- BPMN 2.0の全情報を工程表で管理
- マニュアル自動生成と編集（画像挿入対応）
- **工程表・BPMN・マニュアルの完全同期管理**
- Excel連携（インポート・エクスポート）
- 過去バージョンとの比較・復元

---

## 2. システム要件

### 2.1 動作環境

#### 2.1.1 プラットフォーム
- **種別**: デスクトップアプリケーション
- **対応OS**: 
  - Windows 10/11
  - macOS 10.15以降
  - Linux (Ubuntu 20.04以降)

#### 2.1.2 動作方式
- **完全オフライン動作**: インターネット接続不要
- **ローカル実行**: 全データをローカルPC上で処理
- **スタンドアロン**: 外部サーバー不要

### 2.2 技術スタック

| カテゴリ | 技術・ライブラリ | 用途 |
|---------|----------------|------|
| フロントエンド | Next.js / React | UIフレームワーク |
| デスクトップ化 | Electron | デスクトップアプリ化 |
| Excel操作 | SheetJS (xlsx) | Excel読み書き |
| BPMN編集 | bpmn-js | BPMNフロー編集 |
| データ保存 | SQLite / NeDB | ローカルDB |
| バージョン管理 | Git (libgit2) または 独自実装 | 履歴管理 |
| UI/スタイル | Tailwind CSS + HeroUI | スタイリング・UIコンポーネント |
| 生成AI | OpenAI API / Anthropic API (将来) | マニュアル自動生成 |

---

## 3. 機能要件

### 3.1 Excelファイル連携

#### 3.1.1 読み込み機能
- **入力形式**: Excel形式 (.xlsx, .xls)
- **想定シート構成**:
  - `工程表` シート: 工程の一覧・詳細情報
  - `工程フロー` シート: フロー図関連データ
- **読み込み項目**:
  - 工程ID
  - 工程名
  - 階層レベル（大・中・小・詳細）
  - 部署名（大工程）
  - 作業実行者（中工程）
  - 帳票種類（小工程）
  - 開始日・終了日
  - 依存関係
  - マニュアル有無（詳細レベルのみ）
  - 備考

> **📝 注意**: 工程表の列項目はユーザーからのフィードバックを受けて今後追加・変更される予定です。  
> 列項目の変更に対応できるよう、`metadata`フィールドで拡張可能な設計としています。

#### 3.1.2 書き込み機能
- **出力形式**: Excel形式 (.xlsx)
- **テンプレート機能**: 初期フォーマットの自動生成
- **編集内容の反映**: アプリ上での編集をExcelに出力
- **フォーマット保持**: 元のExcelの書式・レイアウトを可能な限り保持

#### 3.1.3 データマッピング
- Excelの工程表データとBPMNフローの双方向同期
- データ整合性チェック機能

### 3.2 BPMNフローチャート編集

#### 3.2.1 BPMN 2.0対応
- **標準準拠**: BPMN 2.0仕様に準拠
- **ファイル形式**: XML形式（.bpmn）
- **サポート要素**:
  - タスク（Task）
  - イベント（Start/End/Intermediate Events）
  - ゲートウェイ（Gateway）
  - シーケンスフロー（Sequence Flow）
  - サブプロセス（Sub-Process）
  - コールアクティビティ（Call Activity）

#### 3.2.2 編集機能
- **ドラッグ&ドロップ**: 直感的なフロー作成
- **パレット**: BPMN要素の選択・配置
- **プロパティ編集**: 各要素の詳細設定
- **接続管理**: フロー間の関連付け
- **レイアウト自動調整**: フローの自動整列

#### 3.2.3 表示機能
- **ズーム**: 拡大・縮小表示
- **パン**: フロー図の移動
- **フィット**: 画面に収まるよう自動調整
- **印刷プレビュー**: 印刷用レイアウト確認

#### 3.2.4 工程表との双方向同期 ⭐ 必須機能
- **BPMN → 工程表**:
  - BPMNタスク作成時に工程レコードを自動生成
  - タスク名変更時に工程名を自動更新
  - タスク削除時に関連工程を自動削除
  - タスクのdocumentation（説明）を工程の説明として同期
  - カスタムプロパティで工程ID・階層レベルを保持
- **工程表 → BPMN**:
  - 工程作成時にBPMNタスクを自動生成
  - 工程名・説明変更時にBPMN要素を更新
  - 工程削除時にBPMNタスクを削除
  - 階層関係をシーケンスフローで表現
- **同期モード**:
  - 自動同期モード（リアルタイム反映）
  - 手動同期モード（明示的な同期ボタン）
  - 同期ステータス表示（成功/失敗/競合）
- **競合解決**:
  - 同時編集時の競合検出
  - ユーザーによる選択（BPMN優先 or 工程表優先）
  - マージ機能（両方の変更を統合）

### 3.3 フラット構造管理（V2.0.0）

#### 3.3.1 構造定義
V2.0.0では階層構造を撤廃し、フラットな工程表構造を採用しています。

**ProcessTable（工程表）**:
- 全ての工程は単一のProcessTableに属する
- 階層構造は存在せず、フラットに管理

**Swimlane（スイムレーン）**:
- 部署・担当者単位でのグループ化
- Y軸方向の区分け（責任分界）
- 例: 営業部、開発部、経理部

**Step（ステップ）**:
- 時系列単位での工程区分
- X軸方向の区分け（時間の流れ）
- 例: 計画、設計、実装、テスト

**Process（工程）**:
- SwimlaneとStepの交点に配置
- 具体的な作業内容を記述
- ラベル機能で分類可能

**主な利点**:
- シンプルな構造で理解しやすい
- 保守性の向上
- BPMN 2.0との完全な1対1対応
- nextProcessIdsによる自動的なフロー管理

#### 3.3.2 ナビゲーション
- **テーブル表示**: 
  - Y軸: Swimlane（部署・担当者）
  - X軸: Step（時系列）
  - セル: Process（工程）
- **フィルタリング**:
  - スイムレーン別フィルタ
  - ステップ別フィルタ
  - ラベル別フィルタ
- **ソート機能**:
  - 作成日順
  - 更新日順
  - 名前順

#### 3.3.3 BPMNとの連携
- **完全な1対1対応**: ProcessとBPMNノードが完全一致
- **nextProcessIds**: 次工程IDによる自動フロー生成
- **双方向リアルタイム同期**: 3.2.4参照（BPMN ⇔ 工程表）
- **スイムレーン自動生成**: ProcessTableのSwimlaneからBPMNスイムレーンを自動生成

### 3.4 バージョン管理・履歴管理

#### 3.4.1 バージョン保存
- **自動保存**: 編集内容の定期的な自動保存
- **手動コミット**: ユーザーによる明示的なバージョン作成
- **コミットメッセージ**: 変更内容の説明記録
- **タグ機能**: 重要なバージョンへのラベル付け

#### 3.4.2 履歴管理
- **履歴一覧**: 全バージョンの時系列表示
- **詳細情報**:
  - 変更日時
  - 変更者（PC名/ユーザー名）
  - コミットメッセージ
  - 変更ファイル一覧

#### 3.4.3 比較・復元機能
- **差分表示**: 
  - 工程表の項目単位での差分
  - BPMNフローの視覚的な差分表示
- **復元機能**: 過去バージョンへのロールバック
- **ブランチ機能**: 複数の編集ラインの管理（オプション）

### 3.5 データ管理

#### 3.5.1 プロジェクト管理
- **プロジェクト作成**: 新規プロジェクトの初期化
- **プロジェクト一覧**: 既存プロジェクトの表示・選択
- **プロジェクト設定**: メタデータの管理

#### 3.5.2 ローカルストレージ
- **保存場所**: ユーザー指定のフォルダ
- **ファイル構造**:
  ```
  [プロジェクトフォルダ]/
  ├── project.json          # プロジェクト設定
  ├── data.db              # SQLiteデータベース
  ├── excel/               # Excelファイル保存先
  ├── bpmn/                # BPMNファイル保存先
  ├── manuals/             # マニュアルファイル保存先
  └── .versions/           # バージョン履歴
  ```

#### 3.5.3 エクスポート・インポート
- **エクスポート**: プロジェクト全体のアーカイブ化
- **インポート**: アーカイブからのプロジェクト復元
- **形式**: ZIP形式

### 3.6 マニュアル管理 ⭐ コア機能

#### 3.6.1 マニュアルデータベース
- **DB管理**: マニュアルのバージョン管理とメタデータ保存
- **検索機能**: 全文検索・タグ検索
- **カテゴリ管理**: マニュアルの分類・整理
- **工程との紐付け**: ProcessとManualSectionの関連管理

#### 3.6.2 工程表からのマニュアルアウトライン自動生成 ⭐ 将来実装予定
- **対象工程**: 
  - **Process**: 各工程からマニュアルセクションを生成
  - **Swimlane/Step**: スイムレーン・ステップ情報を活用した構造化
  - 工程内容を基にマニュアル構造を自動構成
- **自動生成フロー（将来）**:
  ```
  工程表（ProcessTable → Swimlane/Step → Process）
    ↓
  アウトライン構造生成（章立てのみ）
    ↓
  フラット構造の反映（Swimlane→部署、Step→工程段階、Process→手順）
    ↓
  工程との紐付けID保存
    ↓
  マニュアルアウトライン完成
  ```
- **セクション管理**:
  - V2.0.0のフラット構造に対応
  - Swimlane（部署・担当者）ごとにセクション分け
  - Step（時系列）ごとにサブセクション分け
  - Process（工程）ごとに具体的な手順記述
  - 例: 営業部（Swimlane）→計画（Step）→見積書作成（Process）→手順詳細
- **テンプレート選択**: 
  - 業務マニュアル形式
  - 操作手順書形式
  - フローチャート説明書形式
  - カスタムテンプレート
- **将来実装予定の範囲**:
  - ✅ セクションタイトル（工程名から）
  - ✅ セクション構造（V2フラット構造対応）
  - ✅ 工程IDとの紐付け
  - ✅ プレースホルダーテキスト
  - ❌ 詳細な本文生成（生成AI連携で実装予定）

> **🔮 将来実装予定: 生成AIによる詳細コンテンツ自動生成**
> - 工程名・説明から詳細なマニュアル本文を生成
> - BPMNフロー情報を考慮した文脈生成
> - V2フラット構造を考慮した自然な文章生成
> - BPMNフローの画像挿入
> - 注意事項・ベストプラクティスの提案

#### 3.6.3 工程表との同期 ⭐ 必須機能
- **工程表 → マニュアル（アウトライン）**:
  - 小工程・詳細工程の作成時にマニュアルセクションを自動生成（タイトルのみ）
  - 工程名変更時にマニュアルセクションタイトルを自動更新
  - 工程階層変更時にマニュアルセクション階層を同期
  - 工程削除時に関連マニュアルセクションを削除（警告あり）
  - 工程並び替え時にマニュアルセクション順序も同期
- **マニュアル → 工程表**:
  - セクションタイトル編集時に関連工程名の更新提案
  - セクション削除時に関連工程の確認
  - セクション追加時に対応する工程の作成提案

> **📝 Phase 6制約**: 工程説明変更時のマニュアル本文更新はPhase 7で実装（生成AI連携）
- **同期ステータス**:
  - 工程とマニュアルの同期状態を可視化
  - 未同期箇所の検出とハイライト
  - 自動同期 / 手動同期の選択
- **差分検出**: 
  - 工程とマニュアルの内容不整合を自動検出
  - 更新が必要な箇所の通知
  - マージ機能（両方の変更を統合）

#### 3.6.4 BPMNとの連携
- **BPMN情報の参照（Phase 6）**:
  - マニュアル生成時にBPMNフロー構造を参照
  - タスクの順序をマニュアル手順構造として反映
  - 工程IDを介したBPMNとの紐付け
- **三位一体同期（Phase 6範囲）**:
  ```
  BPMN ⇔ 工程表 → マニュアル（アウトライン）
  
  BPMNタスク変更 → 工程更新 → マニュアル構造更新
  工程変更 → BPMN更新 + マニュアル構造更新
  ```

> **🔮 Phase 7拡張予定**:
> - BPMNダイアグラムの画像をマニュアルに自動挿入
> - マニュアル変更 → 工程更新提案 → BPMN更新提案
> - 生成AIによる三者間の意味的な整合性チェック

#### 3.6.5 マニュアル編集機能（Phase 6実装範囲）
- **セクション構造管理**:
  - 4段階（大・中・小・詳細）でセクションを自動構成
  - ドラッグ&ドロップによるセクション並び替え
  - セクション階層の折りたたみ/展開表示
  - 工程階層と完全同期したツリー構造
- **基本編集機能**:
  - セクションタイトル編集
  - セクション追加・削除
  - プレースホルダーテキスト表示
  - 簡易Markdown編集（手動入力）

> **🔮 Phase 7拡張予定**:
> - 生成AIによる詳細コンテンツ自動生成
> - リッチテキストエディタ強化
> - 画像・図表の自動挿入
> - AI提案による内容拡張
- **工程との紐付け表示**:
  - セクションに対応する工程を明示
  - 工程からマニュアルセクションへのジャンプ
  - マニュアルから工程へのジャンプ

> **🔮 Phase 7以降の拡張予定**:
> - **リッチテキストエディタ強化**: 
>   - WYSIWYG編集モード
>   - 画像・図表挿入（BPMNフロー画像含む）
>   - コードブロック、テーブル、リストのサポート
> - **レビュー機能**: 
>   - コメント・承認フロー
>   - 変更履歴の追跡
>   - バージョン管理との連携

#### 3.6.6 マニュアルエクスポート（Phase 6実装範囲）
- **出力形式（アウトライン）**: 
  - Markdown（章立て構造）
  - HTML（目次のみ）
  - PDF（アウトライン構造）

> **🔮 Phase 7拡張予定**: 詳細コンテンツ含む完全版エクスポート
> - PDF（詳細コンテンツ付き）
> - Word (.docx)（完全版）
> - HTML（完全版）

#### 3.6.7 生成AI連携 🔮 Phase 7実装予定
- **AI支援マニュアル詳細生成**:
  - OpenAI API / Anthropic API / その他LLM APIを活用
  - 工程内容からマニュアル本文を自動生成
  - BPMNフローを解析した手順書生成
  - 自然言語処理によるマニュアル品質向上
- **コンテンツ拡張機能**:
  - 工程説明 → 詳細な手順書に展開
  - 注意事項・ベストプラクティスの提案
  - 図解・例の自動生成
  - 用語解説の自動追加
- **同期更新**:
  - 工程変更時にAIがマニュアル更新案を提示
  - ユーザーレビュー後に自動適用
  - 一貫性チェック（BPMN-工程-マニュアル三者間）

### 3.7 三位一体同期の優先順位 ⭐ システムの中核

#### 3.7.1 同期機能の重要度

| 機能 | 優先度 | 状態 | 備考 |
|------|--------|------|------|
| BPMN ⇔ 工程表（双方向） | 🔴 最高 | ✅ 実装済み | リアルタイム同期 |
| 工程表 → マニュアル（片方向） | 🔴 最高 | 🟡 実装中 | 小工程・詳細工程から生成 |
| マニュアル → 工程表（提案） | 🟡 中 | 🔴 未実装 | 更新提案機能 |
| BPMN → マニュアル（間接） | 🟡 中 | 🔴 未実装 | 工程表経由で同期 |

#### 3.7.2 同期の実装方針

**Phase 1: BPMN ⇔ 工程表（実装済み）**
```
BPMNタスク作成 → 工程レコード生成
BPMNタスク更新 → 工程データ更新
BPMNタスク削除 → 工程レコード削除

工程作成 → BPMNタスク生成
工程更新 → BPMN要素更新
工程削除 → BPMNタスク削除
```

**Phase 2: 工程表 → マニュアル（実装中）**
```
小工程作成 → マニュアルセクション生成（章/節レベル）
詳細工程作成 → マニュアル手順生成（具体的な手順）
工程更新 → マニュアル内容更新
工程削除 → マニュアルセクション削除（警告）
```

**Phase 3: マニュアル → 工程表（将来）**
```
マニュアル編集 → 工程更新提案
マニュアル追加 → 工程作成提案
マニュアル削除 → 工程削除確認
```

#### 3.7.3 データフロー図

```
┌──────────┐        ┌──────────┐        ┌──────────┐
│   BPMN   │◄──────►│  工程表  │───────►│マニュアル│
│  フロー  │ リアル │ (Process)│ 自動   │(Manual) │
│          │  タイム│          │ 生成   │         │
└──────────┘  同期  └──────────┘        └──────────┘
     │                   │                    │
     │                   │                    │
     └───────────────┬───┴────────────────────┘
                     │
                ┌────▼────┐
                │ SQLite  │
                │   DB    │
                └─────────┘
```

**データの流れ**:
1. **BPMNタスク作成** → 工程レコード生成 → マニュアルセクション生成（小工程以降）
2. **工程作成** → BPMNタスク生成 + マニュアルセクション生成（小工程以降）
3. **マニュアル編集** → 工程更新提案 → BPMN更新提案（将来）

---

## 4. 非機能要件

### 4.1 パフォーマンス
- **起動時間**: 5秒以内
- **ファイル読み込み**: 10MB以下のExcelファイルを5秒以内に読み込み
- **フロー描画**: 100ノード以下のBPMNを1秒以内に描画
- **レスポンス**: UI操作のレスポンスは0.1秒以内

### 4.2 ユーザビリティ
- **直感的UI**: 専門知識がなくても操作可能
- **モダンUIコンポーネント**: HeroUIによる統一感のある美しいインターフェース
- **レスポンシブデザイン**: 様々な画面サイズに対応
- **ダークモード対応**: ライト/ダークテーマの切り替え
- **キーボードショートカット**: 主要操作のショートカット対応
- **エラーメッセージ**: 分かりやすいエラー表示と解決策の提示
- **ヘルプ機能**: コンテキストヘルプとユーザーマニュアル

### 4.3 信頼性
- **データ保全**: 編集中のデータ損失防止
- **自動バックアップ**: 定期的な自動バックアップ
- **エラーハンドリング**: 異常終了時の復旧機能

### 4.4 保守性
- **ログ機能**: エラーログ・操作ログの記録
- **設定ファイル**: 外部設定ファイルでのカスタマイズ
- **モジュール設計**: 拡張可能なアーキテクチャ

---

## 5. UI/UX要件

### 5.1 画面構成

#### 5.1.1 メイン画面
```
┌─────────────────────────────────────────────┐
│ [メニュー] [ツールバー]                       │
├────────┬────────────────────────────────────┤
│        │                                    │
│ 階層   │   BPMNフロー編集エリア              │
│ ツリー │                                    │
│        │                                    │
├────────┼────────────────────────────────────┤
│        │   工程表エリア                      │
└────────┴────────────────────────────────────┘
```

#### 5.1.2 主要画面一覧
1. **プロジェクト選択画面**: プロジェクト一覧・新規作成
2. **メイン編集画面**: フロー編集・工程表編集
3. **履歴表示画面**: バージョン履歴・差分比較
4. **マニュアル管理画面**: マニュアル一覧・編集・生成（将来拡張）
5. **設定画面**: アプリケーション設定

### 5.3 UIコンポーネント（HeroUI活用）

#### 5.3.1 使用コンポーネント
- **Navigation**: Navbar, Tabs, Breadcrumbs
- **Data Display**: Table, Card, Avatar, Chip
- **Inputs**: Input, Select, Checkbox, Radio, Switch
- **Feedback**: Modal, Popover, Tooltip, Progress
- **Layout**: Divider, Spacer, Grid

#### 5.3.2 デザインシステム
- **カラーテーマ**: カスタマイズ可能なカラーパレット
- **タイポグラフィ**: 階層的な見出しと本文スタイル
- **スペーシング**: 一貫した余白設定
- **アニメーション**: スムーズなトランジション効果

### 5.2 操作フロー

#### 5.2.1 新規プロジェクト作成
1. プロジェクト名入力
2. 保存先フォルダ選択
3. Excelテンプレート選択（または新規作成）
4. プロジェクト初期化

#### 5.2.2 既存プロジェクト編集
1. プロジェクト選択
2. Excelファイル読み込み
3. BPMNフロー編集 / 工程表編集
4. 保存・コミット
5. Excelエクスポート

---

## 6. データモデル

### 6.1 工程データ

```typescript
interface Process {
  id: string;              // 工程ID
  name: string;            // 工程名
  level: 'large' | 'medium' | 'small' | 'detail'; // 階層レベル（大・中・小・詳細）
  parentId?: string;       // 親工程ID
  
  // 階層レベル別の属性
  department?: string;     // 部署名（大工程の場合）
  assignee?: string;       // 作業実行者（中工程の場合）
  documentType?: string;   // 帳票種類（小工程の場合）
  
  startDate?: Date;        // 開始日
  endDate?: Date;          // 終了日
  status?: string;         // ステータス
  description?: string;    // 説明
  bpmnElementId?: string;  // 対応するBPMN要素ID
  hasManual?: boolean;     // マニュアル有無（詳細レベルのみ）
  manualId?: string;       // 対応するマニュアルID（詳細レベルのみ）
  metadata?: Record<string, any>; // その他のメタデータ
}
```

### 6.2 BPMNデータ
- BPMN 2.0 XML形式に準拠
- カスタム拡張属性で工程表との紐付け情報を保持

### 6.3 バージョンデータ

```typescript
interface Version {
  id: string;              // バージョンID
  timestamp: Date;         // 作成日時
  author: string;          // 作成者
  message: string;         // コミットメッセージ
  tag?: string;            // タグ
  parentVersionId?: string; // 親バージョンID
  files: {                 // 変更ファイル情報
    excel?: string;        // Excelファイルパス
    bpmn?: string[];       // BPMNファイルパス
    manuals?: string[];    // マニュアルファイルパス
  };
}
```

### 6.4 マニュアルデータ（将来拡張）

```typescript
interface Manual {
  id: string;              // マニュアルID
  title: string;           // タイトル
  content: string;         // 本文（Markdown形式）
  targetProcessLevel: 'detail'; // 対象工程レベル（詳細工程のみ）
  processIds: string[];    // 関連工程ID（詳細レベル）
  bpmnElementIds: string[]; // 関連BPMN要素ID
  version: string;         // マニュアルバージョン
  linkedFlowVersion?: string; // 紐付けられたフローバージョン
  status: 'draft' | 'review' | 'approved' | 'outdated'; // ステータス
  tags: string[];          // タグ
  createdAt: Date;         // 作成日時
  updatedAt: Date;         // 更新日時
  author: string;          // 作成者
  reviewers?: string[];    // レビュアー
  metadata?: {             // メタデータ
    template?: string;     // 使用テンプレート
    generatedBy?: 'ai' | 'manual'; // 生成方法
    lastSyncedAt?: Date;   // 最終同期日時
  };
}

interface ManualSection {
  id: string;              // セクションID
  manualId: string;        // 親マニュアルID
  order: number;           // 順序
  level: number;           // セクション階層レベル（1=章、2=節、3=項）
  heading: string;         // 見出し
  content: string;         // 内容
  processId?: string;      // 関連工程ID
  bpmnElementId?: string;  // 関連BPMN要素ID
  parentSectionId?: string; // 親セクションID
  images?: string[];       // 画像パス
}
```

---

## 7. 開発計画

### 7.1 完了済みフェーズ

#### フェーズ0: 環境準備 ✅
- ✅ Next.js + Electron環境構築
- ✅ TypeScript設定
- ✅ 開発環境セットアップ

#### フェーズ1: データベース構築 ✅
- ✅ V2データモデル設計
- ✅ 14テーブル実装
- ✅ マイグレーション実装
- ✅ TypeScript型定義

#### フェーズ2: バックエンドAPI実装 ✅
- ✅ IPC API実装（73個）
- ✅ バックエンドハンドラー実装（36個）
- ✅ BPMN統合機能
- ✅ nextProcessIds自動計算
- ✅ カスタム列JSON統合

### 7.2 未着手フェーズ

#### フェーズ3: フロントエンド実装（次フェーズ）
- [ ] ProcessTableリスト画面
- [ ] ProcessTable詳細画面
- [ ] Process編集画面
- [ ] BPMN編集画面（bpmn-js統合）
- [ ] Excel連携UI

### 7.4 フェーズ4: バージョン管理
- [ ] ローカルDB設計（SQLite）
- [ ] バージョン保存・履歴表示
- [ ] 差分表示・復元機能

### 7.5 フェーズ5: 最適化・テスト
- [ ] パフォーマンス最適化
- [ ] 統合テスト
- [ ] ユーザビリティ改善

### 7.6 フェーズ6: 三位一体同期機能（構造） ✅ 完了
- [x] BPMN ⇔ 工程表の双方向自動同期
- [x] 工程表 → マニュアルアウトライン自動生成
- [x] マニュアル編集UI（基本）
- [x] 三位一体統合ダッシュボード
- [x] 同期ステータス可視化
- [x] ワンクリック全体同期

### 7.7 フェーズ7: 生成AI連携（詳細） 🔮 計画中
- [ ] 生成AI連携基盤の構築（OpenAI/Anthropic）
- [ ] マニュアル詳細コンテンツ自動生成
- [ ] 画像・図解の自動生成
- [ ] 用語解説の自動追加
- [ ] マニュアルDB・全文検索機能
- [ ] 高度なエクスポート（PDF/Word等）

---

## 8. リスクと制約

### 8.1 技術的リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| Excel形式の複雑性 | 中 | SheetJSの制約を事前調査、代替ライブラリの検討 |
| BPMN大規模データの描画性能 | 中 | 仮想化・遅延読み込みの実装 |
| バージョン管理のストレージ容量 | 低 | 差分保存方式の採用 |

### 8.2 制約事項
- オフライン動作のため、クラウド同期機能は対象外
- Excel形式の完全な再現は困難な場合がある
- BPMNの一部高度な機能は初期バージョンで非対応

---

## 9. 将来の拡張性

### 9.1 将来的な機能候補

#### 9.1.1 AI機能拡張
- [ ] **マニュアル自動生成**: 
  - BPMNフローから業務マニュアルのたたき台を自動生成
  - 工程表情報を基にした手順書の構造化
  - 複数のテンプレート形式への対応
- [ ] **フローとマニュアルの同期**:
  - フロー変更時の自動マニュアル更新提案
  - 不整合箇所の自動検出と通知
  - バージョン間の差分を反映したマニュアル更新
- [ ] **マニュアルDB管理**:
  - 全文検索機能
  - タグ・カテゴリによる分類管理
  - 承認ワークフロー
  - 複数出力形式（PDF, Word, HTML, Markdown）
- [ ] **AI支援による工程最適化提案**:
  - ボトルネック検出
  - 並列化可能な工程の提案
  - 過去データからの工程期間予測

#### 9.1.2 その他の機能拡張
- [ ] 複数人での編集（マージ機能）
- [ ] クラウドストレージ連携（オプション）
- [ ] プラグインシステム
- [ ] カスタムBPMN要素の追加
- [ ] ガントチャート表示
- [ ] レポート自動生成

### 9.2 技術的拡張
- [ ] Webブラウザ版の提供
- [ ] モバイルアプリ版
- [ ] API提供による外部ツール連携

---

## 10. 承認・変更履歴

| バージョン | 日付 | 変更者 | 変更内容 |
|-----------|------|--------|---------|
| 1.0 | 2025-10-13 | GitHub Copilot | 初版作成 |
| 1.1 | 2025-10-13 | GitHub Copilot | NextUI追加、生成AIマニュアル機能追加 |
| 1.2 | 2025-10-13 | GitHub Copilot | 階層を4段階（大・中・小・詳細）に変更、マニュアルセクション粒度追加 |
| 1.3 | 2025-10-13 | GitHub Copilot | 工程階層の定義を業務観点に修正（部署・作業実行者・帳票） |
| 1.4 | 2025-10-13 | GitHub Copilot | NextUI→HeroUIに変更（NextUI非推奨のため） |

---

## 付録

### A. 参考資料
- [Electron公式ドキュメント](https://electronjs.org)
- [bpmn-js公式ドキュメント](https://bpmn.io/toolkit/bpmn-js/)
- [SheetJS公式ドキュメント](https://docs.sheetjs.com/)
- [BPMN 2.0仕様](https://www.omg.org/spec/BPMN/2.0/)

### B. 用語集
| 用語 | 説明 |
|------|------|
| BPMN | Business Process Model and Notation - 業務プロセスモデリング表記法 |
| サブプロセス | BPMNにおける階層化されたプロセス要素 |
| コールアクティビティ | 別のプロセスを呼び出すBPMN要素 |
| SheetJS | JavaScriptでExcelファイルを扱うライブラリ |
| Electron | Web技術でデスクトップアプリを作成するフレームワーク |
| HeroUI | React向けのモダンUIコンポーネントライブラリ（NextUIの後継） |
| 生成AI | LLM（大規模言語モデル）を用いたコンテンツ自動生成技術 |
| マニュアルのたたき | 手動で完成させる前の下書き・草稿版マニュアル |

---

**文書末尾**
