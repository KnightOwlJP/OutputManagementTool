# Output Management Tool ユーザーマニュアル

**バージョン**: 1.6  
**最終更新日**: 2025年10月15日  
**Phase 6対応**: 三位一体同期機能追加

---

## 📖 目次

1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [基本操作](#基本操作)
4. [プロジェクト管理](#プロジェクト管理)
5. [工程管理](#工程管理)
6. [階層管理](#階層管理)
7. [BPMNダイアグラム](#bpmnダイアグラム)
8. [🎉 NEW! マニュアル管理](#マニュアル管理)
9. [🎉 NEW! 三位一体同期](#三位一体同期)
10. [Excelインポート・エクスポート](#excelインポートエクスポート)
11. [バージョン管理](#バージョン管理)
12. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

Output Management Toolは、業務プロセスを4段階の階層（大工程・中工程・小工程・詳細工程）で管理し、BPMNダイアグラムとの連携、Excelインポート/エクスポート、バージョン管理機能を提供するデスクトップアプリケーションです。

### 主な機能

- ✅ **4段階階層管理**: 大工程（部署）→ 中工程（作業実行者）→ 小工程（帳票）→ 詳細工程
- ✅ **BPMNエディタ**: bpmn-jsを使用したビジュアルなプロセス設計
- ✅ **🎉 NEW! マニュアル管理**: Markdown形式の手順書作成、セクション管理、プレビュー機能
- ✅ **🎉 NEW! 三位一体同期**: BPMN・工程表・マニュアルを自動連携・同期
- ✅ **Excelインポート/エクスポート**: 既存のExcelシートから工程データをインポート、またはエクスポート
- ✅ **バージョン管理**: プロジェクト全体のスナップショット作成、復元、比較
- ✅ **ドラッグ&ドロップ**: 直感的な階層構造の編集
- ✅ **検索・フィルタ**: 工程名、説明、部署、担当者で絞り込み

---

## インストール

### システム要件

- **OS**: Windows 10/11, macOS 10.15+, Linux (Ubuntu 20.04+)
- **メモリ**: 4GB RAM以上推奨
- **ストレージ**: 500MB以上の空き容量

### インストール手順

1. リリースページから最新版のインストーラーをダウンロード
2. インストーラーを実行
3. 画面の指示に従ってインストール
4. アプリケーションを起動

---

## 基本操作

### 初回起動

1. アプリケーションを起動すると、ホーム画面が表示されます
2. 左側のサイドバーから各機能にアクセスできます
3. 右上の検索バーで工程を検索できます

### サイドバーメニュー

- **🏠 ホーム**: ダッシュボード画面
- **📁 プロジェクト**: プロジェクト一覧
- **🔄 工程管理**: 全工程の一覧と編集
- **🌳 階層管理**: 階層構造の可視化と編集
- **📊 BPMN**: BPMNダイアグラム編集
- **� マニュアル**: 🎉 NEW! 手順書作成・管理
- **🔄 Trinity**: 🎉 NEW! 三位一体同期ダッシュボード
- **�🔖 バージョン**: バージョン履歴と管理
- **⚙️ 設定**: アプリケーション設定

### ショートカットキー

- `Ctrl/Cmd + N`: 新規プロジェクト作成
- `Ctrl/Cmd + S`: 保存
- `Ctrl/Cmd + F`: 検索
- `Ctrl/Cmd + Z`: 元に戻す（BPMNエディタ内）
- `Ctrl/Cmd + Y`: やり直す（BPMNエディタ内）

---

## プロジェクト管理

### プロジェクトの作成

1. サイドバーから **📁 プロジェクト** をクリック
2. 右上の **新規プロジェクト** ボタンをクリック
3. プロジェクト情報を入力
   - **プロジェクト名** (必須): わかりやすい名前を付けます
   - **説明**: プロジェクトの概要や目的を記述
4. **作成** ボタンをクリック

### プロジェクトの編集

1. プロジェクト一覧から編集したいプロジェクトをクリック
2. プロジェクト詳細画面で **編集** ボタンをクリック
3. 情報を修正して **保存** をクリック

### プロジェクトの削除

1. プロジェクト一覧で削除したいプロジェクトのカードにカーソルを合わせる
2. 右上の **ゴミ箱アイコン** をクリック
3. 確認ダイアログで **削除** をクリック

⚠️ **注意**: プロジェクトを削除すると、関連する全ての工程、BPMNダイアグラム、バージョン履歴が削除されます。この操作は取り消せません。

---

## 工程管理

### 工程の作成

1. プロジェクト詳細画面または工程管理画面で **工程を追加** ボタンをクリック
2. 工程フォームで以下の情報を入力

#### 共通フィールド

- **工程名** (必須): 工程の名前
- **説明**: 工程の詳細説明
- **レベル** (必須): 階層レベルを選択
  - **大工程 (Level 1)**: 部署レベル
  - **中工程 (Level 2)**: 作業実行者レベル
  - **小工程 (Level 3)**: 帳票レベル
  - **詳細工程 (Level 4)**: 最小単位
- **親工程**: 親となる工程を選択（大工程以外）

#### レベル別フィールド

**大工程 (Level 1)**
- **部署名** (必須): 実行部署
- **部署コード**: 部署識別コード

**中工程 (Level 2)**
- **作業実行者** (必須): 担当者名
- **役職**: 担当者の役職

**小工程 (Level 3)**
- **帳票種類** (必須): 使用する帳票の種類
- **帳票番号**: 帳票の管理番号

**詳細工程 (Level 4)**
- **所要時間**: 作業時間（分）
- **チェックポイント**: 確認事項

3. **保存** ボタンをクリック

### 工程の編集

1. 工程一覧で編集したい工程の **編集アイコン** をクリック
2. 情報を修正して **保存** をクリック

### 工程の削除

1. 工程一覧で削除したい工程の **ゴミ箱アイコン** をクリック
2. 確認ダイアログで **削除** をクリック

⚠️ **注意**: 子工程がある工程は削除できません。まず子工程を削除または移動してください。

### 工程の検索

1. 工程一覧画面上部の検索バーにキーワードを入力
2. 以下の項目が検索対象となります
   - 工程名
   - 説明
   - 部署名
   - 作業実行者
   - 帳票種類

### レベルフィルタ

工程一覧画面上部のレベルフィルタボタンをクリックすると、特定レベルの工程のみを表示できます。

---

## 階層管理

### 階層ツリーの表示

1. サイドバーから **🌳 階層管理** をクリック
2. プロジェクトの全階層構造がツリー表示されます

### 階層の展開・折りたたみ

- **個別展開**: 工程名の左の **▶** アイコンをクリック
- **全展開**: 画面上部の **すべて展開** ボタンをクリック
- **全折りたたみ**: 画面上部の **すべて折りたたむ** ボタンをクリック

### ドラッグ&ドロップで階層を変更

1. 移動したい工程をドラッグ
2. 新しい親工程の上でドロップ
3. 循環参照（親子関係のループ）が発生する場合は警告が表示されます

⚠️ **制限事項**:
- レベル1の工程は親を持てません
- レベル2以上の工程は必ず親が必要です
- 親のレベルは子のレベルより小さい必要があります

### 表示順の変更

1. 階層管理画面で **表示順変更** ボタンをクリック
2. 工程を上下矢印で移動、または数値を直接入力
3. **保存** ボタンをクリック

### 階層の統計情報

階層管理画面の上部に各レベルの工程数が表示されます。

---

## BPMNダイアグラム

### BPMNダイアグラムの作成

1. プロジェクト詳細画面で **BPMNエディタを開く** をクリック
2. 左側のツールパレットから要素をドラッグ&ドロップ
3. 要素をクリックして編集
4. **保存** ボタンをクリック

### BPMN要素の種類

- **タスク**: 作業単位
- **イベント**: 開始、終了、中間イベント
- **ゲートウェイ**: 排他、並列、包含ゲートウェイ
- **シーケンスフロー**: 要素間の流れ
- **プール・レーン**: 組織や役割の区分

### ツールバー操作

- **元に戻す / やり直す**: 編集履歴の操作
- **ズームイン / ズームアウト**: 表示倍率の変更
- **フィット**: ダイアグラム全体を画面に収める
- **XMLエクスポート**: BPMN XMLファイルとして保存
- **SVGエクスポート**: 画像ファイルとして保存

### BPMNダイアグラムの複数管理

1つのプロジェクトに複数のBPMNダイアグラムを作成できます。

1. BPMN画面で **新規ダイアグラム** ボタンをクリック
2. ダイアグラム名を入力
3. 左側のリストから編集したいダイアグラムを選択

---

## マニュアル管理

### マニュアルの作成

1. プロジェクト詳細画面で **マニュアル** ボタンをクリック
2. **新規マニュアル** ボタンをクリック
3. マニュアル情報を入力
   - **タイトル** (必須): マニュアルの名前
   - **説明**: マニュアルの概要
4. **作成** ボタンをクリック

### マニュアルの編集

1. マニュアル一覧から編集したいマニュアルをクリック
2. マニュアルエディタが開きます

#### セクション管理

左側のセクションツリーで構造を管理します：

- **新規セクション**: **+ セクション追加** ボタンをクリック
- **セクション編集**: セクション名をクリックして編集
- **セクション削除**: セクション右の **ゴミ箱アイコン** をクリック
- **セクション移動**: ドラッグ&ドロップで順序変更

#### Markdownエディタ

中央のエディタでMarkdown形式でコンテンツを記述します：

**基本的なMarkdown記法**:
```markdown
# 見出し1
## 見出し2
### 見出し3

**太字** *斜体* `コード`

- リストアイテム1
- リストアイテム2

1. 番号付きリスト
2. 番号付きリスト

[リンク](https://example.com)

\`\`\`
コードブロック
\`\`\`
```

#### タブ切り替え

- **編集タブ**: Markdownエディタ
- **プレビュータブ**: リアルタイムプレビュー

### プロセスからマニュアル生成

工程表から自動的にマニュアルを生成できます：

1. マニュアル一覧で **プロセスから生成** ボタンをクリック
2. 生成オプションを選択
   - **階層レベル**: 含める工程レベルを選択
   - **セクション構造**: 階層ごとにセクション分割
3. **生成** ボタンをクリック

生成されたマニュアルは、工程の階層構造に基づいて自動的に整形されます。

### マニュアルのエクスポート

複数の形式でエクスポートできます：

1. マニュアル一覧または編集画面で **エクスポート** ボタンをクリック
2. 形式を選択
   - **Markdown (.md)**: 元のMarkdown形式
   - **HTML (.html)**: Webページとして
   - **PDF (.pdf)**: 印刷用PDF（※将来対応予定）
3. 保存場所を選択して **保存** をクリック

### マニュアルの検索

1. マニュアル一覧画面上部の検索バーにキーワードを入力
2. タイトル、説明、セクション名が検索対象となります

### マニュアルの削除

1. マニュアル一覧で削除したいマニュアルの **ゴミ箱アイコン** をクリック
2. 確認ダイアログで **削除** をクリック

---

## 三位一体同期

Phase 6で追加された強力な同期機能です。BPMN、工程表、マニュアルを自動的に連携させます。

### Trinity Dashboard（三位一体ダッシュボード）

プロジェクト詳細画面の紫色のバナーから **三位一体同期ダッシュボード** にアクセスできます。

#### ダッシュボードの機能

1. **フル同期**: BPMN → Process → Manual の一括同期
2. **個別同期**: 各方向の同期を個別実行
   - BPMN → Process（BPMNから工程表を更新）
   - Process → Manual（工程表からマニュアルを更新）
   - BPMN → Manual（BPMNから直接マニュアルを更新）
3. **自動同期**: 変更時に自動的に同期
4. **同期ステータス**: 各システムの同期状態を表示

### 自動同期の有効化

1. Trinity Dashboardで **Auto Sync** トグルをONにする
2. BPMNまたは工程を編集すると、自動的に他のシステムに反映されます

### BPMN同期パネル

BPMNエディタ内にも同期パネルが統合されています：

1. BPMNエディタの右側に **Sync** パネルが表示されます
2. **Auto Sync** トグルで自動同期をON/OFF
3. 個別の同期ボタンで手動同期も可能

### 同期の仕組み

#### BPMN → Process
- BPMNのタスクが工程として作成されます
- タスク名 → 工程名
- タスクの説明 → 工程の説明
- レーン情報 → 部署・担当者

#### Process → Manual
- 工程の階層構造がセクションとして生成されます
- 大工程 → 章
- 中工程 → 節
- 小工程・詳細工程 → 手順ステップ
- 各工程の説明がマニュアルのコンテンツになります

#### BPMN → Manual（直接）
- BPMNのフローを手順書として生成
- シーケンスフローに沿った順序で記述
- ゲートウェイは条件分岐として表現

### 同期結果の確認

同期実行後、結果が表示されます：

- **成功**: ✅ 緑色のチェックマーク
- **エラー**: ❌ 赤色のエラーアイコン
- **統計情報**: 更新された項目数

### 同期の競合解決

複数の場所で同時に編集された場合：

1. **タイムスタンプベース**: 最後に保存された変更が優先されます
2. **手動マージ**: 競合が検出された場合は警告が表示されます
3. **バージョン管理**: 同期前にバージョンを作成することを推奨

### 同期の制限事項

- 自動生成されたマニュアルを手動編集すると、次回の同期で上書きされる可能性があります
- 大規模なプロジェクト（1000工程以上）では同期に時間がかかる場合があります
- BPMNの複雑な構造（ネストしたサブプロセスなど）は簡略化される場合があります

### 同期のベストプラクティス

1. **定期的にバージョンを作成**: 同期前に現在の状態を保存
2. **自動同期は段階的に有効化**: まず手動同期で動作を確認
3. **マニュアルの手動編集は慎重に**: 自動生成フラグを確認
4. **大きな変更後は全体同期**: Trinity Dashboardのフル同期を実行

---

## Excelインポート・エクスポート

### Excelからのインポート

1. プロジェクト詳細画面で **Excelインポート** ボタンをクリック
2. **ファイルを選択** ボタンをクリック
3. インポートするExcelファイルを選択
4. プレビューで内容を確認
5. **インポート** ボタンをクリック

#### Excelフォーマット

以下の列が必要です（1行目はヘッダー）:

| 列名 | 必須 | 説明 |
|------|------|------|
| 大工程 | ○ | レベル1の工程名 |
| 部署名 | ○ | 実行部署 |
| 中工程 | - | レベル2の工程名 |
| 作業実行者 | - | 担当者 |
| 小工程 | - | レベル3の工程名 |
| 帳票種類 | - | 使用帳票 |
| 詳細工程 | - | レベル4の工程名 |
| 説明 | - | 工程説明 |

### Excelへのエクスポート

1. プロジェクト詳細画面で **Excelエクスポート** ボタンをクリック
2. 保存場所とファイル名を指定
3. **保存** ボタンをクリック

エクスポートされたExcelファイルには全階層の工程が含まれます。

### Excelテンプレートのダウンロード

1. インポート画面で **テンプレートをダウンロード** をクリック
2. サンプルデータ入りのExcelファイルが取得できます

---

## バージョン管理

### バージョンの作成

1. サイドバーから **🔖 バージョン** をクリック
2. **新しいバージョンを作成** ボタンをクリック
3. バージョン情報を入力
   - **メッセージ** (必須): 変更内容の説明
   - **タグ** (任意): バージョンの分類（例: v1.0, リリース候補）
   - **作成者** (任意): 作成者名
4. **作成** ボタンをクリック

バージョンには以下が含まれます:
- 全工程データ（階層構造含む）
- 全BPMNダイアグラム
- プロジェクト設定

### バージョン履歴の表示

バージョン管理画面にタイムライン形式で履歴が表示されます。

- **最新バージョン**: 青いバッジで表示
- **タグ付きバージョン**: タグ名が表示
- **作成日時**: 相対時間（例: 2時間前）
- **統計情報**: 工程数、BPMNダイアグラム数

### バージョンの復元

1. バージョン履歴から復元したいバージョンを選択
2. **復元** ボタンをクリック
3. 確認ダイアログで内容を確認
4. **復元する** をクリック

⚠️ **注意**: 復元すると現在のデータが上書きされます。復元前に現在の状態をバージョンとして保存することをお勧めします。

### バージョンの比較

1. バージョン履歴で比較したい2つのバージョンを選択（チェックボックス）
2. **比較** ボタンをクリック
3. 差分サマリーと詳細な変更リストが表示されます

比較内容:
- 追加された工程
- 削除された工程
- 変更された工程（名前、説明、階層位置など）
- BPMNダイアグラムの変更

### タグ管理

タグを使用してバージョンを分類できます。

#### タグの作成
1. バージョン管理画面の **タグ管理** セクションへ移動
2. **新しいタグ** ボタンをクリック
3. タグ名を入力して **追加** をクリック

#### タグでフィルタ
タグ一覧のボタンをクリックすると、そのタグが付いたバージョンのみを表示できます。

### バージョンの削除

1. バージョン履歴で削除したいバージョンの **削除アイコン** をクリック
2. 確認ダイアログで **削除** をクリック

---

## トラブルシューティング

### よくある問題と解決方法

#### Excelインポートが失敗する

**原因**: Excelファイルのフォーマットが正しくない

**解決方法**:
1. テンプレートをダウンロードして形式を確認
2. 必須列（大工程、部署名）が存在するか確認
3. セルの書式が「文字列」になっているか確認

#### 工程が削除できない

**原因**: 子工程が存在する

**解決方法**:
1. 階層管理画面で子工程を確認
2. 子工程を先に削除または他の親に移動
3. その後、親工程を削除

#### BPMNエディタが表示されない

**原因**: ブラウザの互換性またはキャッシュの問題

**解決方法**:
1. アプリケーションを再起動
2. キャッシュをクリア（設定 > キャッシュをクリア）
3. 最新版にアップデート

#### 同期が失敗する

**原因**: データの整合性やネットワークの問題

**解決方法**:
1. 同期前にバージョンを作成
2. 個別同期（BPMN→Process、Process→Manual）を順番に実行
3. エラーメッセージを確認してログを確認
4. 一時的にAuto Syncを無効にして手動同期を試す

#### マニュアルが自動生成されない

**原因**: 工程データまたはBPMNデータが不足

**解決方法**:
1. 工程表に最低1つ以上の工程が存在するか確認
2. BPMNダイアグラムにタスクが含まれているか確認
3. Trinity Dashboardで同期ステータスを確認
4. 同期履歴を確認してエラーがないかチェック

#### バージョン復元後にエラーが発生する

**原因**: データ整合性の問題

**解決方法**:
1. 別のバージョンに復元してみる
2. アプリケーションを再起動
3. サポートに連絡（ログファイルを添付）

### ログファイルの場所

エラーが発生した場合、以下の場所にログファイルがあります:

- **Windows**: `C:\Users\{ユーザー名}\AppData\Roaming\output-management-tool\logs\`
- **macOS**: `~/Library/Application Support/output-management-tool/logs/`
- **Linux**: `~/.config/output-management-tool/logs/`

ログファイル:
- `app-YYYY-MM-DD.log`: 一般ログ
- `error-YYYY-MM-DD.log`: エラーログ

### データベースの場所

プロジェクトデータは以下の場所に保存されています:

- **Windows**: `C:\Users\{ユーザー名}\Documents\OutputManagementTool\`
- **macOS**: `~/Documents/OutputManagementTool/`
- **Linux**: `~/Documents/OutputManagementTool/`

バックアップを取る場合は、このフォルダ全体をコピーしてください。

---

## サポート

### バグ報告・機能リクエスト

GitHubのIssueページで報告してください: https://github.com/your-org/output-management-tool/issues

### お問い合わせ

技術サポート: support@example.com

---

## ライセンス

このソフトウェアは MITライセンス の下で提供されています。

---

**Output Management Tool v1.0**  
© 2025 All Rights Reserved.
